在网络安全领域，漏洞发现是渗透测试、安全评估和攻防演练的核心环节。无论是攻击者寻找突破口，还是防御者修补短板，都离不开对系统漏洞的精准识别。根据扫描方式的不同，漏洞发现可分为两大类：远程探针扫描（Remote Probing）和本地自检（Local Inspection）。前者通过网络对目标系统进行主动探测，后者则在获得一定权限后，在本地进行漏洞分析和提权路径挖掘。本文将从理论和实践两个维度，深入探讨这两类技术，并结合主流工具（如Nessus、Nexpose、Goby、Wesng、Linux Exploit Suggester等）和实际漏洞案例（CVE-2021-1732、CVE-2019-1458）展开分析，旨在帮助读者构建完整的漏洞发现知识体系。

一、远程探针：漏洞扫描的“先遣队”

远程漏洞扫描是指扫描器通过网络向目标主机发送精心构造的探测包，根据响应判断是否存在已知漏洞。这类工具通常拥有庞大的漏洞库，能够快速识别操作系统、服务、应用程序中的常见弱点。它们就像攻防战中的“先遣队”，在未接触目标内部之前，通过外部侦察绘制出初步的攻击面。

1.1 Nessus：漏洞扫描的行业标杆

Nessus是Tenable公司开发的漏洞扫描程序，被誉为世界上最流行的漏洞扫描工具，全球超过75000个组织在使用它。其核心优势在于：

· 全面的漏洞覆盖：Nessus的漏洞数据库实时更新，涵盖操作系统、网络设备、数据库、Web应用等各类目标。
· 灵活的部署方式：支持本地或远程遥控扫描，既可安装在内部网络进行深度扫描，也可通过云端进行外部评估。
· 丰富的报告与合规性检查：可生成详细的风险等级、修复建议报告，并支持PCI DSS、HIPAA等合规性扫描。

实践要点：安装Nessus相对简单，可参考官方文档或社区教程（如提供的微信文章链接）。使用时需注意配置扫描策略（如避开业务高峰期），并合理设置凭证扫描以获得更准确的本地配置评估。

1.2 Nexpose：与Metasploit联动的“黄金搭档”

Nexpose是Rapid7公司的商业漏洞扫描工具，与Metasploit渗透测试框架师出同门，因此两者具有天然的集成优势。其特色包括：

· 动态漏洞更新：基于Rapid7的安全研究，及时纳入“补丁星期二”等最新漏洞。
· 攻击向量关联：能明确指出哪些漏洞可被Metasploit直接利用，哪些在Exploit-DB中存在公开利用代码，极大方便了后续渗透。
· 强大的报告系统：提供丰富的统计图表和漏洞详情，支持导出为HTML、PDF、XML等格式。

实践要点：Nexpose的安装对Java环境有一定要求，若启动失败可尝试切换JDK版本（如课程演示中需设置为JDK 17）。对于大型复杂网络，Nexpose的高效扫描引擎能显著缩短评估时间，是红队人员的首选之一。

1.3 Goby：实战化的“攻击面管理”工具

Goby是由赵武（Zwell）打造的新一代网络安全测试工具，其设计理念从“漏洞扫描”延伸至“攻击面梳理”。它的独特之处在于：

· 智能资产识别：通过多种协议主动发现目标IP、端口、服务、Web应用等，并自动关联域名、证书等信息。
· 实战化漏洞验证：内置大量PoC，可对漏洞进行深度验证，并支持从验证点一键进入横向渗透（如反弹Shell、端口转发）。
· 自动化与可视化：以图形化方式展示攻击路径，帮助渗透人员快速定位薄弱环节，降低上手门槛。

实践场景：Goby尤其适合红蓝对抗中的快速打点，通过自动化方式梳理出最全的攻击面，减少手动信息收集的时间成本。

小结：远程探针的选择策略

· Nessus：适合常规合规扫描、漏洞普查，报告详尽，社区支持完善。
· Nexpose：适合需要与Metasploit深度整合的场景，对后续渗透有直接指导作用。
· Goby：适合实战化攻防演练，强调攻击面管理和快速验证，对新手友好。

远程扫描虽能发现大量外部可见漏洞，但无法覆盖那些需要本地权限才能触发的漏洞（如权限提升、本地信息泄露）。因此，在获取初步访问权限后，本地自检便成为下一步的关键。

二、本地自检：从内部发现“深水区”漏洞

本地自检是指在获得目标系统的一定权限（如普通用户Shell）后，在系统内部进行漏洞检测，主要目的是寻找提权路径、本地溢出漏洞或配置缺陷。这类技术依赖于对系统补丁级别、内核版本、服务配置的深入分析，常被用于权限维持和后渗透阶段。

2.1 Windows本地提权漏洞检测

Windows系统的漏洞提权通常涉及内核漏洞、服务漏洞或错误配置。手工检测费时费力，而自动化工具能极大提升效率。

· wesng (Windows Exploit Suggester - Next Generation)
    wesng是Windows漏洞提权建议工具的升级版，它通过对比目标系统的补丁列表（systeminfo输出）与微软漏洞数据库，给出可能存在的提权漏洞列表。其原理基于补丁包与CVE的映射关系，无需运行任何漏洞利用代码即可快速筛选。
  使用方法：
  1. 在目标主机执行 systeminfo > sysinfo.txt。
  2. 将sysinfo.txt传输到攻击机，运行 python wes.py sysinfo.txt。
  3. wesng输出匹配的CVE编号、KB编号及利用参考链接。
· 其他资源：如曾经流行的在线工具 https://i.hacking8.com/tiquan（已关闭）也提供类似功能。社区中还有基于PowerShell的脚本（如Sherlock、Watson），可进一步自动化检测。

2.2 Linux本地提权漏洞检测

Linux系统的漏洞提权同样依赖内核版本和已安装软件。linux-exploit-suggester（LES）是这一领域的代表性工具。

· linux-exploit-suggester
    该脚本通过分析uname -a、cat /etc/issue等命令的输出，与内置的漏洞数据库匹配，给出可能适用的本地提权漏洞。它支持根据内核版本精确推荐PoC，并标注漏洞利用的可靠性。
  使用示例：
  ```bash
  $ ./linux-exploit-suggester.sh
  ```
  输出结果包含CVE编号、漏洞名称、所需内核版本范围以及Exploit-DB链接。部分高版本还支持--checksec模式，检测内核防护机制（如SMEP、KASLR）是否开启，帮助筛选可用漏洞。

2.3 PoC与CVE资源库

无论Windows还是Linux，实际利用漏洞往往需要具体的PoC（Proof of Concept）代码。GitHub上有大量收集整理的PoC仓库，例如：

· PoC-in-GitHub：由1nnocent1维护的PoC收集项目，涵盖众多CVE，并提供对应的漏洞描述和利用代码链接。可作为漏洞验证的快速索引。

2.4 典型案例分析

Win10提权：CVE-2021-1732

CVE-2021-1732是Windows Win32k组件中的一个权限提升漏洞，影响Windows 10及Windows Server多个版本。该漏洞通过恶意应用程序在特定窗口操作中实现权限提升。利用代码已在GitHub公开（如KaLendsi/CVE-2021-1732-Exploit），攻击者在获得普通用户权限后，可执行该Exploit获取SYSTEM权限。

检测方法：使用wesng可发现该漏洞的存在（需系统未安装2021年2月安全更新）。实践时应注意仅在授权环境中测试。

Win08提权：CVE-2019-1458

CVE-2019-1458同样是一个Win32k漏洞，影响Windows 7、Windows Server 2008等旧系统。其利用原理与CVE-2021-1732类似，但针对不同内核版本。公开PoC（如rip1s/CVE-2019-1458）展示了从普通用户到SYSTEM的提权过程。

Linux提权通用实践

对于Linux系统，首先使用linux-exploit-suggester获取候选漏洞列表，然后根据系统环境和防护机制选择合适的PoC。例如，在旧内核（如2.6.x）中，经典的“脏牛”漏洞（CVE-2016-5195）仍广泛存在；在新版本中则需考虑更多限制条件。

小结：本地自检的关键点

· 补丁分析：基于systeminfo或内核版本与漏洞库的对比是最基础且有效的方法。
· 防护机制检测：现代系统往往开启多种防护（如ASLR、SMEP），选择漏洞时需验证其绕过能力。
· PoC适配：不同系统环境可能需要调整编译参数或内存地址，直接运行公开代码可能失败，需具备一定调试能力。

三、理论与实践结合：构建完整的漏洞发现流程

在真实的渗透测试或攻防演练中，远程探针与本地自检并非孤立，而是相辅相成的两个阶段：

1. 信息收集与远程扫描：首先使用Nessus/Nexpose/Goby对目标进行全端口、全服务扫描，获取初步的漏洞清单（如弱口令、未授权访问、公开服务漏洞）。
2. 初步利用与权限获取：针对远程漏洞进行利用，获得一个低权限会话（如WebShell、普通用户Shell）。
3. 本地自检与提权：在目标内部运行wesng或linux-exploit-suggester，寻找可能的提权漏洞，上传并执行PoC，获取更高权限（如SYSTEM或root）。
4. 横向移动与持续检测：利用新权限进行内网扩展，对新主机重复上述流程。

理论支撑：这一流程体现了纵深防御的对抗思想——攻击面从外部收缩到内部，漏洞类型从网络服务扩展到本地内核。同时，它也符合漏洞生命周期的管理原则：及时发现、验证、修复。

实践建议：

· 所有操作必须在授权范围内进行，严禁非法入侵。
· 扫描工具应定期更新漏洞库，以保证检测准确率。
· 本地自检工具最好提前在测试环境验证，避免在目标系统上触发异常。
· 结合CVSS评分和漏洞实际可利用性（如是否存在公开PoC）对风险进行优先级排序。

四、结语

漏洞发现是网络安全对抗中的“眼睛”和“耳朵”。远程探针工具如Nessus、Nexpose、Goby帮助我们快速绘制外部攻击面，而本地自检工具如wesng、linux-exploit-suggester则指引我们在内部纵深挖掘。两者结合，才能构建完整的漏洞发现能力。随着攻防技术的演进，自动化、智能化已成为趋势，但核心仍在于对漏洞原理的深刻理解和实战经验的积累。希望本文能为安全从业者和学习者提供有价值的参考，在系统攻防的道路上走得更远。

---

参考资料（文中已包含链接，此处汇总）

· Nessus安装教程：https://mp.weixin.qq.com/s/gEnd45Ujf4ydjtgtoGBqrg
· Nexpose下载：https://www.rapid7.com/products/insightvm/download/
· Goby官网及文档
· wesng：https://github.com/bitsadmin/wesng
· linux-exploit-suggester：https://github.com/mzet-/linux-exploit-suggester
· PoC-in-GitHub：https://github.com/1nnocent1/PoC-in-GitHub
· CVE-2021-1732 Exploit：https://github.com/KaLendsi/CVE-2021-1732-Exploit
· CVE-2019-1458 Exploit：https://github.com/rip1s/CVE-2019-1458

（注：部分链接可能需要科学上网或已变更，请以实际为准。）
